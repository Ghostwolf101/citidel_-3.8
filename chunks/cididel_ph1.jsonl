{"doc_id": "cididel_ph1", "chunk_id": "cididel_ph1__0", "chunk_text": "Phase 1: Base Fortress Setup\n\n \n\n#!/bin/sh\n\necho \"🛡️ Phase 1: Base Fortress Deploying...\"\n\n \n\n# Step 1: Default Firewall Policies - Accept all initially\n\nuci set firewall.@defaults[0].input='ACCEPT'\n\nuci set firewall.@defaults[0].output='ACCEPT'\n\nuci set firewall.@defaults[0].forward='ACCEPT'\n\n \n\n# Step 2: Flush existing iptables rules\n\niptables -F\n\niptables -X\n\n \n\n# Step 3: Configure LAN zone - fully trusted\n\nuci delete firewall.lan 2>/dev/null\n\nuci set firewall.lan=zone\n\nuci set firewall.lan.name='lan'\n\nuci set firewall.lan.input='ACCEPT'\n\nuci set firewall.lan.output='ACCEPT'\n\nuci set firewall.lan.forward='ACCEPT'\n\nuci set firewall.lan.network='lan'\n\n \n\n# Step 4: Configure WAN zone - restrictive\n\nuci delete firewall.wan 2>/dev/null\n\nuci set firewall.wan=zone\n\nuci set firewall.wan.name='wan'\n\nuci set firewall.wan.input='REJECT'\n\nuci set firewall.wan.output='ACCEPT'\n\nuci set firewall.wan.forward='REJECT'\n\nuci set firewall.wan.masq='1'\n\nuci set firewall.wan.mtu_fix='1'\n\nuci set firewall.wan.network='wan wan6'\n\n \n\n# Step 5: Block LuCI (web GUI) from WAN\n\nuci delete firewall.block_luci_from_wan 2>/dev/null\n\nuci set firewall.block_luci_from_wan='rule'\n\nuci set firewall.block_luci_from_wan.name='Block LuCI From WAN'\n\nuci set firewall.block_luci_from_wan.src='wan'\n\nuci set firewall.block_luci_from_wan.dest_port='80 443'\n\nuci set firewall.block_luci_from_wan.proto='tcp'\n\nuci set firewall.block_luci_from_wan.target='REJECT'\n\n \n\n# Step 6: Drop all WAN input by default\n\nuci delete firewall.drop_all_wan_input 2>/dev/null\n\nuci set firewall.drop_all_wan_input='rule'\n\nuci set firewall.drop_all_wan_input.name='Drop All WAN Input'\n\nuci set firewall.drop_all_wan_input.src='wan'\n\nuci set firewall.drop_all_wan_input.proto='all'\n\nuci set firewall.drop_all_wan_input.target='DROP'\n\n \n\n# Step 7: Allow LAN to WAN forwarding\n\nuci delete firewall.lan_forwarding 2>/dev/null\n\nuci set firewall.lan_forwarding='forwarding'\n\nuci set firewall.lan_forwarding.src='lan'\n\nuci set firewall.lan_forwarding.dest='wan'\n\n \n\n# Step 8: Enable SYN flood protection and drop invalid packets\n\nuci set firewall.@defaults[0].synflood_protect='1'\n\nuci set firewall.@defaults[0].drop_invalid='1'\n\n \n\n# Step 9: Secure DNS - use Quad9\n\nuci set network.wan.peerdns='0'\n\nuci set network.wan.dns='9.9.9.9 149.112.112.112'\n\nuci commit network\n\n \n\n# Step 10: Disable SSH password login (only key-based allowed)\n\nuci set dropbear.@dropbear[0].PasswordAuth='off'\n\nuci commit dropbear\n\n/etc/init.d/dropbear restart\n\n \n\n# Step 11: Commit and restart firewall and network services\n\nuci commit firewall\n\n/etc/init.d/firewall restart\n\n/etc/init.d/network restart", "source_filename": "cididel_ph1.txt", "source_sha256": "2574ad86c2294acc99338957793ba3eeaba66c88ec7a4d29776c9be7c68cd38f", "chunk_index": 0, "total_chunks": 1}
